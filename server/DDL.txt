create table group_mem
(
	group_id int not null,
	user_id int not null,
	role varchar(45) default 'member' null,
	created_at timestamp default CURRENT_TIMESTAMP null,
	updated_at timestamp default CURRENT_TIMESTAMP null,
	deleted_at timestamp null,
	primary key (group_id, user_id)
)
;

create index FK3
	on group_mem (user_id)
;

create table groups
(
	group_id int not null auto_increment
		primary key,
	group_name varchar(45) default 'newgroup' not null,
	capacity int default '100' null,
	master int null,
	status varchar(45) default 'active' null,
	icon varchar(45) null,
	created_at timestamp default CURRENT_TIMESTAMP null,
	updated_at timestamp default CURRENT_TIMESTAMP null,
	deleted_at timestamp null
)
;

create index FK1
	on groups (master)
;

alter table group_mem
	add constraint FK2
		foreign key (group_id) references letmeknow_test.groups (group_id)
;

create table message
(
	message_id int not null auto_increment
		primary key,
	sender_id int not null,
	receiver_id int not null,
	content varchar(45) null,
	created_at timestamp default CURRENT_TIMESTAMP not null,
	updated_at timestamp default CURRENT_TIMESTAMP not null,
	deleted_at timestamp null
)
;

create index FK4
	on message (sender_id)
;

create index FK5
	on message (receiver_id)
;

create table user
(
	user_id int(10) not null auto_increment
		primary key,
	username varchar(255) not null,
	password varchar(255) not null,
	email varchar(255) null,
	phone_num int null,
	is_admin varchar(255) default 'non-admin' null,
	status varchar(255) default 'active' null,
	created_at timestamp default CURRENT_TIMESTAMP not null,
	updated_at timestamp default CURRENT_TIMESTAMP not null,
	deleted_at timestamp null,
	constraint username_UNIQUE
		unique (username)
)
;

alter table group_mem
	add constraint FK3
		foreign key (user_id) references letmeknow_test.user (user_id)
;

alter table groups
	add constraint FK1
		foreign key (master) references letmeknow_test.user (user_id)
;

alter table message
	add constraint FK4
		foreign key (sender_id) references letmeknow_test.user (user_id)
;

alter table message
	add constraint FK5
		foreign key (receiver_id) references letmeknow_test.user (user_id)
;

